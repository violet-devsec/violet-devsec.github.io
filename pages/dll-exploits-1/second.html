<!DOCTYPE HTML>
<!--
	Future Imperfect by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Dll Exploits - I</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../assets/css/main.css" />
        <link rel="stylesheet" href="../../assets/css/app.css"/>
        <style>
            .m-hero__picture {
              background-image: url(../../images/dll-exploits-1/dll_exploits_1_bg.jpg);
            }
          
            @media(max-width: 1000px) {
              .m-hero__picture {
                background-image: url(../../images/dll-exploits-1/dll_exploits_1_bg.jpg);
              }
            }
          
            @media(max-width: 600px) {
              .m-hero__picture {
                background-image: url(../../images/dll-exploits-1/dll_exploits_1_bg.jpg);
              }
            }
          </style>
	</head>
	<body class="single is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="../../index.html">Violet Devsec</a></h1>
                        <!--
                            <nav class="links">
                                <ul>
                                    <li><a href="#">Lorem</a></li>
                                    <li><a href="#">Ipsum</a></li>
                                    <li><a href="#">Feugiat</a></li>
                                    <li><a href="#">Tempus</a></li>
                                    <li><a href="#">Adipiscing</a></li>
                                </ul>
                            </nav>
                        -->
						<nav class="main">
							<ul>
								<li class="search">
									<a class="fa-search" href="#search">Search</a>
									<form id="search" method="get" action="#">
										<input type="text" name="query" placeholder="Search" />
									</form>
								</li>
								<li class="menu">
									<a class="fa-bars" href="#menu">Menu</a>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Menu -->
					<section id="menu">

						<!-- Search -->
							<section>
								<form class="search" method="get" action="#">
									<input type="text" name="query" placeholder="Search" />
								</form>
							</section>

						<!-- Links -->
							<section>
								<ul class="links">
									<li>
										<a href="#">
											<h3>Lorem ipsum</h3>
											<p>Feugiat tempus veroeros dolor</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Dolor sit amet</h3>
											<p>Sed vitae justo condimentum</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Feugiat veroeros</h3>
											<p>Phasellus sed ultricies mi congue</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Etiam sed consequat</h3>
											<p>Porta lectus amet ultricies</p>
										</a>
									</li>
								</ul>
							</section>

						<!-- Actions -->
							<section>
								<ul class="actions stacked">
									<li><a href="#" class="button large fit">Log In</a></li>
								</ul>
							</section>

					</section>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<article class="post">
								<header>
									<div class="title">
										<h2><a href="#">DLL Exploits Part-I : StrongName Signing and Authenticode Signing</a></h2>
										<p></p>
									</div>
									<div class="meta">
										<time class="published" datetime="2015-11-01">February 18, 2022</time>
										<a href="#" class="author"><span class="name">Violet Devsec</span><img src="../../images/avatar.jpg" alt="" /></a>
									</div>
								</header>
                                <section class="m-hero with-picture aos-init aos-animate" data-aos="fade">
                                    <div class="m-hero__picture in-post"></div>
                                </section>
                                <!--Post content-->
                                        <div class="l-post-content   js-progress-content">
                                            <div class="pos-relative js-post-content">
                                                <p></p>
                                                <ol start="10">
                                                    <li>
                                                        <strong>Adding two scripts to sign all DLLs</strong>
														<p>Copied two Powershell scripts into the build output folder. These are nothing but a very small script iterate signing process over all exe/dll in the present folder.</p>
														<img src="../../images/dll-exploits-1/dll_exploits_1_15.png" alt="" />
                                                    </li>
                                                    <li>
                                                        <strong>Add StrongName signing</strong>
														<p>Strong name the delay signed DLL using Signing key.</p>
														<img src="../../images/dll-exploits-1/dll_exploits_1_17.png" alt="" />
                                                    </li>
                                                    <li>
                                                        <strong>Create Authenticode signing certificate</strong>
														<p>Create Code signing cert to Cert store</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_19.png" alt="" />
														<img src="../../images/dll-exploits-1/dll_exploits_1_20.png" alt="" />
                                                    </li>
                                                    <li>
                                                        <strong>Export the PFX file</strong>
														<p>Export the PFX file and provide a password when prompted during export process.</p>
														<p>(Note: We can export it using PowerShell command also,
															Export-PfxCertificate -Cert "Cert:\CurrentUser\My\$($cert.Thumbprint)" "d:\CodeSigningCert.pfx" -Password <password>)</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_21.png" alt="" />
														<img src="../../images/dll-exploits-1/dll_exploits_1_22.png" alt="" />
                                                    </li>
                                                    <li>
                                                        <strong>Add Authenticode sign</strong>
														<p>We can sign and verify signing using below commands:</p>
														<p>signtool sign /f .\CodeSignCert.pfx /p <password> .\MyAssembly_signed.dll</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_23.png" alt="" />
														<img src="../../images/dll-exploits-1/dll_exploits_1_24.png" alt="" />
                                                    </li>
													<li>
                                                        <strong>Check DLL metadata again</strong>
														<p>Now we can see that a new block has been added. This is the public key added for strong naming.</p>
														<p>(Note: Delay signing also adds the public key details to the manifest. It is basically the public key value in "public.snk" file)</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_28.png" alt="" />
                                                    </li>
													<li>
                                                        <strong>Check PE content</strong>
														<p>Authenticode signature data can also find from the file content.</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_30.png" alt="" />
                                                    </li>
													<li>
                                                        <strong>Add Code sign certificate to Trusted Root store</strong>
														<p>The signature validation is being passed on this machine as the code signing cert has been added to the Trusted Root store in this machine. Otherwise, program won't start up and if we check the inner exception, it will say root certificate is not trusted.</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_32.png" alt="" />
                                                    </li>
													<li>
                                                        <strong>Run the application</strong>
														<p>Now, if we run the Exe again from the Release folder, the Calculator App will start.</p>
                                                        <img src="../../images/dll-exploits-1/dll_exploits_1_31.png" alt="" />
                                                    </li>
                                                </ol>
                                                <!-- Pagination -->
                                                <ul class="actions pagination">  
                                                    <li><a href="index.html" class="button large previous">Previous Page</a></li>
                                                    <li><a href="second.html" class="disabled button large next" style="position: absolute; right: 0;">Next Page</a></li>
                                                
                                                </ul>
                                            </div>
                                            
                                        </div>
                                         
								<footer>
									<ul class="stats">
										<li><a href="#">General</a></li>
										<li><a href="#" class="icon solid fa-heart">28</a></li>
										<li><a href="#" class="icon solid fa-comment">128</a></li>
									</ul>
								</footer>
							</article>
                           
					</div>

				<!-- Footer -->
					<section id="footer">
						<ul class="icons">
							<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
							<li><a href="#" class="icon solid fa-rss"><span class="label">RSS</span></a></li>
							<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
						</ul>
						<p class="copyright">&copy; Untitled. Design: <a href="http://html5up.net">HTML5 UP</a>. Images: <a href="http://unsplash.com">Unsplash</a>.</p>
					</section>

			</div>

		<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/browser.min.js"></script>
			<script src="../../assets/js/breakpoints.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<script src="../../assets/js/main.js"></script>

	</body>
</html>